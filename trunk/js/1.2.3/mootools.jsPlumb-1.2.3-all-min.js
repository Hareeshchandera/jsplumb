(function(){var x=function(){var k=this,s=/MSIE/.test(navigator.userAgent)&&!window.opera,u=null,t=function(){var a={};this.bind=function(b,c){var e=a[b];if(!e){e=[];a[b]=e}e.push(c)};this.fireUpdate=function(b,c){if(a[b])for(var e=0;e<a[b].length;e++)try{a[b][e](c)}catch(j){}}},n={},o={},g={},h=[],p={},i={},z=true,d=[],r={},C="DEFAULT",F=1200,D=function(a,b,c){var e=function(l,w){if(l===w)return true;else if(typeof l=="object"&&typeof w=="object"){var B=true,y;for(y in l)if(!e(l[y],w[y])){B=false;
break}for(y in w)if(!e(w[y],l[y])){B=false;break}return B}};c=+c||0;for(var j=a.length;c<j;c++)if(e(a[c],b))return c;return-1},I=function(a,b,c){var e=a[b];if(e==null){e=[];a[b]=e}e.push(c);return e},N=function(a,b){var c=O(a,"id"),e=n[c];if(e){var j=""+(new Date).getTime();W(c,b);for(var l=h[c],w=d[c],B=0;B<e.length;B++){var y=e[B],E=y.connections;if(y.anchor.isSelective&&E.length>0){var v=E[0],J=v.endpoints[0]==y?1:0,H=J==0?v.sourceId:v.targetId,m=h[H];H=d[H];m=y.anchor.compute([l.left,l.top],w,
y,[m.left,m.top],H,v.endpoints[J])}else m=y.anchor.compute([l.left,l.top],w,y);y.paint(m);for(v=0;v<E.length;v++){E[v].paint(c,b,false,j);J=E[v].endpoints[0]==y?1:0;if(E[v].endpoints[J].anchor.isSelective){H=J==0?E[v].sourceId:E[v].targetId;m=h[H];H=d[H];m=E[v].endpoints[J].anchor.compute([m.left,m.top],H,E[v].endpoints[J],[l.left,l.top],w,y);E[v].endpoints[J].paint(m)}}}}},R=function(a,b){var c=null;if(typeof a=="object"&&a.length){c=[];for(var e=0;e<a.length;e++){var j=G(a[e]),l=O(j,"id");c.push(b(j,
l))}}else{j=G(a);l=O(j,"id");c=b(j,l)}return c},ca=function(a,b){var c=r[a];if(c)for(var e in c)try{c[e][a](b)}catch(j){}},da={},G=function(a){if(typeof a=="string"){var b=da[a];if(!b){b=f.CurrentLibrary.getElementObject(a);da[a]=b}return b}else return f.CurrentLibrary.getElementObject(a)},O=function(a,b){var c=G(a);return f.CurrentLibrary.getAttribute(c,b)},ea=function(a,b,c){a=G(a);f.CurrentLibrary.setAttribute(a,b,c)},ha=function(a){a=G(a);return f.CurrentLibrary.getOffset(a)},ia=function(a){a=
G(a);return f.CurrentLibrary.getSize(a)},Y=function(a,b){var c=G(a),e=O(c,"id");if(!e){e=arguments.length==2?b:"_jsPlumb_"+new String((new Date).getTime());ea(c,"id",e)}return e},aa=function(a,b,c){if(b=b==null?z:b)if(f.CurrentLibrary.isDragSupported(a)){c=c||k.Defaults.DragOptions||f.Defaults.DragOptions;c=f.extend({},c);b=f.CurrentLibrary.dragEvents.drag;c[b]=T(c[b],function(){var e=f.CurrentLibrary.getUIPosition(arguments);N(a,e);e=G(a);f.CurrentLibrary.addClass(e,"jsPlumb_dragged")});b=i[Y(a)];
c.disabled=b==null?false:!b;f.CurrentLibrary.initDraggable(a,c)}},ja=function(a,b,c){var e=document.createElement("canvas"),j=e;b?f.CurrentLibrary.appendElement(j,b):document.body.appendChild(j);e.style.position="absolute";if(a)e.className=a;Y(e,c);if(s){f.sizeCanvas(e,0,0,F,F);e=G_vmlCanvasManager.initElement(e)}return e},fa=function(a,b){var c=n[a];if(c&&c.length)for(var e=0;e<c.length;e++)for(var j=0;j<c[e].connections.length;j++)if(b(c[e].connections[j]))return},S=function(a,b){if(a!=null)if(b)f.CurrentLibrary.removeElement(a,
b);else try{document.body.removeChild(a)}catch(c){}},Z=function(a,b,c){a=a[b];if(a!=null){c=D(a,c);if(c>=0){delete a[c];a.splice(c,1);return true}}return false},ka=function(a,b){var c=O(a,"id");fa(c,function(e){e.canvas.style.display=b})},na=function(a){fa(a,function(b){b.canvas.style.display="none"==b.canvas.style.display?"block":"none"})},W=function(a,b,c){if(c||b==null){b=G(a);d[a]=ia(b);h[a]=ha(b)}else h[a]=b},T=function(a,b){a=a||function(){};b=b||function(){};return function(){var c=null;try{c=
b.apply(this,arguments)}catch(e){}try{a.apply(this,arguments)}catch(j){}return c}},la=function(a){var b=this;this.x=a.x||0;this.y=a.y||0;var c=a.orientation||[0,0],e=null;this.offsets=a.offsets||[0,0];this.compute=function(j,l,w){e=[j[0]+b.x*l[0]+b.offsets[0],j[1]+b.y*l[1]+b.offsets[1]];l=w?w.container:null;j={left:0,top:0};if(l!=null){var B=G(l);l=ha(B);w=f.CurrentLibrary.getScrollLeft(B);B=f.CurrentLibrary.getScrollTop(B);j.left=l.left-w;j.top=l.top-B;e[0]-=j.left;e[1]-=j.top}return e};this.getOrientation=
function(){return c};this.equals=function(j){if(!j)return false;var l=j.getOrientation(),w=this.getOrientation();return this.x==j.x&&this.y==j.y&&this.offsets[0]==j.offsets[0]&&this.offsets[1]==j.offsets[1]&&w[0]==l[0]&&w[1]==l[1]}},oa=function(a){var b=a.reference,c=ia(G(a.referenceCanvas)),e=0,j=0,l=null;this.compute=function(w){j=e=0;return[w[0]+c[0]/2,w[1]+c[1]/2]};this.getOrientation=function(){if(l)return l;else{var w=b.getOrientation();return[Math.abs(w[0])*e*-1,Math.abs(w[1])*j*-1]}};this.over=
function(w){l=w.getOrientation()};this.out=function(){l=null}},pa=function(a){this.isDynamic=this.isSelective=true;var b=a||[];this.addAnchor=function(j){b.push(j)};var c=b.length>0?b[0]:null;this.locked=false;var e=this;this.compute=function(j,l,w,B,y,E){if(e.locked||B==null||y==null)return c.compute(j,l,w,B,y,E);for(var v=B[0]+y[0]/2,J=B[1]+y[1]/2,H=-1,m=Infinity,M=0;M<b.length;M++){var P=Math.sqrt(Math.pow(v-(j[0]+b[M].x*l[0]),2)+Math.pow(J-(j[1]+b[M].y*l[1]),2));if(P<m){H=M+0;m=P}}c=b[H];return c.compute(j,
l,w,B,y,E)};this.getOrientation=function(){return c!=null?c.getOrientation():[0,0]};this.over=function(j){c!=null&&c.over(j)};this.out=function(){c!=null&&c.out()}},ma=function(a){t.apply(this);var b=this,c=new String("_jsplumb_c_"+(new Date).getTime());this.getId=function(){return c};this.container=a.container||k.Defaults.Container;this.source=G(a.source);this.target=G(a.target);if(a.sourceEndpoint)this.source=a.sourceEndpoint.getElement();if(a.targetEndpoint)this.target=a.targetEndpoint.getElement();
this.sourceId=O(this.source,"id");this.targetId=O(this.target,"id");this.endpointsOnTop=a.endpointsOnTop!=null?a.endpointsOnTop:true;this.scope=a.scope;this.endpoints=[];this.endpointStyles=[];var e=function(y,E,v,J){if(y){b.endpoints[E]=y;y.addConnection(b)}else{if(!v.endpoints)v.endpoints=[null,null];y=v.endpoints[E]||v.endpoint||k.Defaults.Endpoints[E]||f.Defaults.Endpoints[E]||k.Defaults.Endpoint||f.Defaults.Endpoint||new f.Endpoints.Dot;if(!v.endpointStyles)v.endpointStyles=[null,null];var H=
v.endpointStyles[E]||v.endpointStyle||k.Defaults.EndpointStyles[E]||f.Defaults.EndpointStyles[E]||k.Defaults.EndpointStyle||f.Defaults.EndpointStyle,m=v.anchors?v.anchors[E]:k.Defaults.Anchors[E]||f.Defaults.Anchors[E]||k.Defaults.Anchor||f.Defaults.Anchor||f.Anchors.BottomCenter,M=v.uuids?v.uuids[E]:null;v=v.uuids?new ba({style:H,endpoint:y,connections:[b],uuid:M,anchor:m,source:J,container:b.container}):new ba({style:H,endpoint:y,connections:[b],anchor:m,source:J,container:b.container});return b.endpoints[E]=
v}},j=e(a.sourceEndpoint,0,a,b.source);j&&I(n,this.sourceId,j);(e=e(a.targetEndpoint,1,a,b.target))&&I(n,this.targetId,e);if(!this.scope)this.scope=this.endpoints[0].scope;this.connector=this.endpoints[0].connector||this.endpoints[1].connector||a.connector||k.Defaults.Connector||f.Defaults.Connector||new f.Connectors.Bezier;this.paintStyle=this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||a.paintStyle||k.Defaults.PaintStyle||f.Defaults.PaintStyle;this.backgroundPaintStyle=this.endpoints[0].connectorBackgroundStyle||
this.endpoints[1].connectorBackgroundStyle||a.backgroundPaintStyle||k.Defaults.BackgroundPaintStyle||f.Defaults.BackgroundPaintStyle;this.overlays=a.overlays||[];this.addOverlay=function(y){overlays.push(y)};this.labelStyle=a.labelStyle||k.Defaults.LabelStyle||f.Defaults.LabelStyle;(this.label=a.label)&&this.overlays.push(new f.Overlays.Label({labelStyle:this.labelStyle,label:this.label}));W(this.sourceId);W(this.targetId);this.distanceFrom=function(y){return b.connector.distanceFrom(y)};this.setLabel=
function(y){b.label=y;k.repaint(b.source)};e=h[this.sourceId];j=d[this.sourceId];var l=h[this.targetId];otherWH=d[this.targetId];var w=this.endpoints[0].anchor.compute([e.left,e.top],j,this.endpoints[0],[l.left,l.top],otherWH,this.endpoints[1]);this.endpoints[0].paint(w);w=this.endpoints[1].anchor.compute([l.left,l.top],otherWH,this.endpoints[1],[e.left,e.top],j,this.endpoints[0]);this.endpoints[1].paint(w);var B=ja(f.connectorClass,b.container);this.canvas=B;this.paint=function(y,E,v){var J=this.targetId,
H=this.sourceId;if(this.canvas.getContext){W(y,E,v);W(J);E=h[H];v=h[J];var m=d[H],M=d[J];J=B.getContext("2d");H=this.endpoints[0].anchor.compute([E.left,E.top],m,this.endpoints[0],[v.left,v.top],M,this.endpoints[1]);this.endpoints[0].anchor.getOrientation();E=this.endpoints[1].anchor.compute([v.left,v.top],M,this.endpoints[1],[E.left,E.top],m,this.endpoints[0]);this.endpoints[1].anchor.getOrientation();for(m=v=0;m<b.overlays.length;m++){M=b.overlays[m];M=M.computeMaxSize(b.connector,J);if(M>v)v=M}var P=
this.connector.compute(H,E,this.endpoints[0].anchor,this.endpoints[1].anchor,this.paintStyle.lineWidth,v);f.sizeCanvas(B,P[0],P[1],P[2],P[3]);H=function(K,Q){K.save();f.extend(K,Q);if(Q.gradient&&!s){for(var X=b.connector.createGradient(P,K,y==this.sourceId),U=0;U<Q.gradient.stops.length;U++)X.addColorStop(Q.gradient.stops[U][0],Q.gradient.stops[U][1]);K.strokeStyle=X}b.connector.paint(P,K);K.restore()};this.backgroundPaintStyle!=null&&H(J,this.backgroundPaintStyle);H(J,this.paintStyle);for(m=0;m<
b.overlays.length;m++){M=b.overlays[m];M.draw(b.connector,J)}}};this.repaint=function(){this.paint(this.sourceId,null,true)};aa(b.source,a.draggable,a.dragOptions);aa(b.target,a.draggable,a.dragOptions);this.source.resize&&this.source.resize(function(){f.repaint(b.sourceId)})},ba=function(a){a=a||{};f.extend({},a);var b=this,c=new String("_jsplumb_e_"+(new Date).getTime());this.getId=function(){return c};b.anchor=a.anchor||f.Anchors.TopCenter;var e=a.endpoint||new f.Endpoints.Dot,j=a.style||k.Defaults.EndpointStyle||
f.Defaults.EndpointStyle;this.connectorStyle=a.connectorStyle;this.connector=a.connector;this.isSource=a.isSource||false;this.isTarget=a.isTarget||false;var l=a.source,w=a.uuid;if(w)o[w]=b;this.container=a.container||k.Defaults.Container||f.Defaults.Container;var B=O(l,"id"),y=a.maxConnections||1;this.canvas=a.canvas||ja(f.endpointClass,this.container,a.uuid);this.connections=a.connections||[];this.scope=a.scope||C;var E=a.reattach||false,v=null,J=null;this.dragAllowedWhenFull=a.dragAllowedWhenFull||
true;this.addConnection=function(q){b.connections.push(q)};this.detach=function(q){var L=D(b.connections,q);if(L>=0){var A=q.endpoints[0]==b?q.endpoints[1]:q.endpoints[0];b.connections.splice(L,1);A.detach(q)}};this.detachAll=function(){for(;b.connections.length>0;)b.detach(b.connections[0])};this.detachFrom=function(q){for(var L=[],A=0;A<b.connections.length;A++)if(b.connections[A].endpoints[1]==q||b.connections[A].endpoints[0]==q)L.push(b.connections[A]);for(A=0;A<L.length;A++){q.detach(L[A]);b.detach(L[A])}};
this.getElement=function(){return l};this.getUuid=function(){return w};this.makeInPlaceCopy=function(){return new ba({anchor:b.anchor,source:l,style:j,endpoint:e})};this.isConnectedTo=function(q){var L=false;if(q)for(var A=0;A<b.connections.length;A++)if(b.connections[A].endpoints[1]==q){L=true;break}return L};this.isFloating=function(){return v!=null};this.isFull=function(){return y<1?false:b.connections.length>=y};this.setDragAllowedWhenFull=function(q){b.dragAllowedWhenFull=q};this.equals=function(q){return this.anchor.equals(q.anchor)&&
true};this.paint=function(q,L,A){u&&u.debug("Painting Endpoint with elementId ["+B+"]; anchorPoint is ["+q+"]");if(q==null){q=h[B];var V=d[B];if(q==null||V==null){W(B);q=h[B];V=d[B]}q=b.anchor.compute([q.left,q.top],V,b)}e.paint(q,b.anchor.getOrientation(),A||b.canvas,j,L||j)};this.removeConnection=this.detach;if(a.isSource&&f.CurrentLibrary.isDragSupported(l)){var H=null;var m=c=null,M=false,P=null,K=a.dragOptions||{},Q=f.extend({},f.CurrentLibrary.defaultDragOptions);K=f.extend(Q,K);K.scope=K.scope||
b.scope;Q=f.CurrentLibrary.dragEvents.start;var X=f.CurrentLibrary.dragEvents.stop,U=f.CurrentLibrary.dragEvents.drag;K[Q]=T(K[Q],function(){m=b.connections.length<y?null:b.connections[0];if(b.isFull()&&!b.dragAllowedWhenFull)return false;W(B);J=b.makeInPlaceCopy();J.paint();H=document.createElement("div");var q=G(H),L=H,A=b.container;A?f.CurrentLibrary.appendElement(L,A):document.body.appendChild(L);L=""+new String((new Date).getTime());ea(q,"id",L);W(L);ea(G(b.canvas),"dragId",L);ea(G(b.canvas),
"elId",B);A=new oa({reference:b.anchor,referenceCanvas:b.canvas});v=new ba({style:{fillStyle:"rgba(0,0,0,0)"},endpoint:e,anchor:A,source:q});if(m==null){b.anchor.locked=true;m=new ma({sourceEndpoint:b,targetEndpoint:v,source:G(l),target:G(H),anchors:[b.anchor,A],paintStyle:a.connectorStyle,connector:a.connector})}else{M=true;q=m.sourceId==B?0:1;m.floatingAnchorIndex=q;b.removeConnection(m);if(q==0){P=[m.source,m.sourceId];m.source=G(H);m.sourceId=L}else{P=[m.target,m.targetId];m.target=G(H);m.targetId=
L}m.endpoints[q==0?1:0].anchor.locked=true;m.suspendedEndpoint=m.endpoints[q];m.endpoints[q]=v}p[L]=m;v.addConnection(m);I(n,L,v)});K[U]=T(K[U],function(){var q=f.CurrentLibrary.getUIPosition(arguments);f.CurrentLibrary.setOffset(H,q);N(G(H),q)});K[X]=T(K[X],function(){Z(n,c,v);for(var q=[H,v.canvas],L=0;L<q.length;L++)S(q[L],l);S(J.canvas,l);q=m.floatingAnchorIndex==null?1:m.floatingAnchorIndex;m.endpoints[q==0?1:0].anchor.locked=false;if(m.endpoints[q]==v)if(M&&m.suspendedEndpoint)if(E){m.floatingAnchorIndex=
null;if(q==0){m.source=P[0];m.sourceId=P[1]}else{m.target=P[0];m.targetId=P[1]}m.endpoints[q]=m.suspendedEndpoint;m.suspendedEndpoint.addConnection(m);f.repaint(P[1])}else{m.endpoints[0].removeConnection(m);m.endpoints[1].removeConnection(m);S(m.canvas,b.container);Z(g,m.scope,m);ca("jsPlumbConnectionDetached",{source:m.source,target:m.target,sourceId:m.sourceId,targetId:m.targetId,sourceEndpoint:m.endpoints[0],targetEndpoint:m.endpoints[1]})}else{S(m.canvas,b.container);b.removeConnection(m)}b.anchor.locked=
false;m=null;delete v;delete J;b.paint()});Q=G(b.canvas);f.CurrentLibrary.initDraggable(Q,K)}if(a.isTarget&&f.CurrentLibrary.isDropSupported(l)){K=a.dropOptions||k.Defaults.DropOptions||f.Defaults.DropOptions;K=f.extend({},K);K.scope=K.scope||b.scope;Q=f.CurrentLibrary.dragEvents.drop;X=f.CurrentLibrary.dragEvents.over;U=f.CurrentLibrary.dragEvents.out;K[Q]=T(K[Q],function(){var q=f.CurrentLibrary.getDragObject(arguments),L=O(G(q),"dragId");q=O(G(q),"elId");var A=p[L],V=A.floatingAnchorIndex==null?
1:A.floatingAnchorIndex,qa=V==0?1:0;if(!b.isFull()&&!(V==0&&!b.isSource)&&!(V==1&&!b.isTarget)){if(V==0){A.source=l;A.sourceId=B}else{A.target=l;A.targetId=B}A.endpoints[V].removeConnection(A);A.suspendedEndpoint&&A.suspendedEndpoint.removeConnection(A);A.endpoints[V]=b;b.addConnection(A);A.endpoints[qa].addConnection(A);I(g,A.scope,A);aa(l,a.draggable,{});f.repaint(q);ca("jsPlumbConnection",{source:A.source,target:A.target,sourceId:A.sourceId,targetId:A.targetId,sourceEndpoint:A.endpoints[0],targetEndpoint:A.endpoints[1]})}delete p[L]});
K[X]=T(K[X],function(){var q=f.CurrentLibrary.getDragObject(arguments);q=O(G(q),"dragId");q=p[q];q.endpoints[q.floatingAnchorIndex==null?1:q.floatingAnchorIndex].anchor.over(b.anchor)});K[U]=T(K[U],function(){var q=f.CurrentLibrary.getDragObject(arguments);q=O(G(q),"dragId");q=p[q];q.endpoints[q.floatingAnchorIndex==null?1:q.floatingAnchorIndex].anchor.out()});f.CurrentLibrary.initDroppable(G(b.canvas),K)}return b};this.Defaults={Anchor:null,Anchors:[null,null],BackgroundPaintStyle:null,Connector:null,
Container:null,DragOptions:{},DropOptions:{},Endpoint:null,Endpoints:[null,null],EndpointStyle:{fillStyle:null},EndpointStyles:[null,null],LabelStyle:{fillStyle:"rgba(0,0,0,0)",color:"black"},MaxConnections:null,PaintStyle:{lineWidth:10,strokeStyle:"red"},Scope:"_jsPlumb_DefaultScope"};this.connectorClass="_jsPlumb_connector";this.endpointClass="_jsPlumb_endpoint";this.Anchors={};this.Connectors={};this.Endpoints={};this.Overlays={};this.addEndpoint=function(a,b){b=f.extend({},b);var c=G(a),e=O(c,
"id");b.source=c;W(e);c=new ba(b);I(n,e,c);var j=h[e];e=c.anchor.compute([j.left,j.top],d[e],c);c.paint(e);return c};this.addEndpoints=function(a,b){for(var c=[],e=0;e<b.length;e++)c.push(k.addEndpoint(a,b[e]));return c};this.animate=function(a,b,c){var e=G(a),j=O(a,"id");c=c||{};a=f.CurrentLibrary.dragEvents.step;var l=f.CurrentLibrary.dragEvents.complete;c[a]=T(c[a],function(){k.repaint(j)});c[l]=T(c[l],function(){k.repaint(j)});f.CurrentLibrary.animate(e,b,c)};this.clearCache=function(){delete da;
da={}};this.autoConnect=function(a){var b=[],c=[],e=a.endpoint||k.Defaults.EndpointStyle||f.Defaults.EndpointStyle,j=y||k.Defaults.DynamicAnchors||f.Defaults.DynamicAnchors,l=function(E,v){for(var J=0;J<E.length;J++)v.push(E[J])},w=a.source,B=a.target,y=a.anchors;typeof w=="string"?b.push(G(w)):l(w,b);typeof B=="string"?c.push(G(B)):l(B,c);a=f.extend(a,{source:null,target:null,anchors:null});for(l=0;l<b.length;l++)for(w=0;w<c.length;w++){B=f.addEndpoint(b[l],f.extend({anchor:f.makeDynamicAnchor(j)},
e));y=f.addEndpoint(c[w],f.extend({anchor:f.makeDynamicAnchor(j)},e));k.connect(f.extend(a,{sourceEndpoint:B,targetEndpoint:y}))}};this.connect=function(a){var b=f.extend({},a);if(a.uuids){var c=function(e){var j=o[a.uuids[e]];if(!j)throw"Endpoint with UUID "+a.uuids[e]+" not found.";return j};b.sourceEndpoint=c(0);b.targetEndpoint=c(1)}if(!(b.sourceEndpoint&&b.sourceEndpoint.isFull()))if(!(b.targetEndpoint&&b.targetEndpoint.isFull())){b=new ma(b);I(g,b.scope,b);ca("jsPlumbConnection",{source:b.source,
target:b.target,sourceId:b.sourceId,targetId:b.targetId,sourceEndpoint:b.endpoints[0],targetEndpoint:b.endpoints[1]});N(b.source);return b}};var ga=function(a){ca("jsPlumbConnectionDetached",{source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]})};this.detach=function(a,b){if(arguments.length==2){var c=function(e){if(e.sourceId==a&&e.targetId==b||e.targetId==a&&e.sourceId==b){S(e.canvas,e.container);e.endpoints[0].removeConnection(e);
e.endpoints[1].removeConnection(e);Z(g,e.scope,e);ga(e);return true}};fa(a,c)}else if(arguments.length==1){c=f.extend({},a);if(c.uuids)o[c.uuids[0]].detachFrom(o[c.uuids[1]]);else if(c.sourceEndpoint&&c.targetEndpoint)c.sourceEndpoint.detachFrom(c.targetEndpoint);else{a=Y(c.source);b=Y(c.target);c=function(e){if(e.sourceId==a&&e.targetId==b||e.targetId==a&&e.sourceId==b){S(e.canvas,e.container);e.endpoints[0].removeConnection(e);e.endpoints[1].removeConnection(e);Z(g,e.scope,e);ga(e);return true}};
fa(a,c)}}};this.detachAll=function(a){a=O(a,"id");if((a=n[a])&&a.length)for(var b=0;b<a.length;b++){var c=a[b].connections.length;if(c>0)for(var e=0;e<c;e++){var j=a[b].connections[0];S(j.canvas,j.container);j.endpoints[0].removeConnection(j);j.endpoints[1].removeConnection(j);Z(g,j.scope,j);ga(j)}}};this.detachEverything=function(){for(var a in n){var b=n[a];if(b&&b.length)for(var c=0;c<b.length;c++){var e=b[c].connections.length;if(e>0)for(var j=0;j<e;j++){var l=b[c].connections[0];S(l.canvas,l.container);
l.endpoints[0].removeConnection(l);l.endpoints[1].removeConnection(l);ga(l)}}}delete g;g={}};this.draggable=function(a,b){if(typeof a=="object"&&a.length)for(var c=0;c<a.length;c++){var e=G(a[c]);e&&aa(e,true,b)}else(e=G(a))&&aa(e,true,b)};this.extend=function(a,b){return f.CurrentLibrary.extend(a,b)};this.getConnections=function(a){var b={};a=a||{};var c=function(B){var y=[];if(B)if(typeof B=="string")y.push(B);else y=B;return y},e=c(a.scope),j=c(a.source);a=c(a.target);for(var l in g)if(e.length>
0?D(e,l)!=-1:true){b[l]=[];for(c=0;c<g[l].length;c++){var w=g[l][c];(j.length>0?D(j,w.sourceId)!=-1:true)&&(a.length>0?D(a,w.targetId)!=-1:true)&&b[l].push({sourceId:w.sourceId,targetId:w.targetId,source:w.source,target:w.target,sourceEndpoint:w.endpoints[0],targetEndpoint:w.endpoints[1]})}}return b};this.getDefaultScope=function(){return C};this.getEndpoint=function(a){return o[a]};this.getId=Y;this.hide=function(a){ka(a,"none")};this.makeAnchor=function(a,b){var c={};if(arguments.length==1)f.extend(c,
a);else{c={x:a,y:b};if(arguments.length>=4)c.orientation=[arguments[2],arguments[3]];if(arguments.length==6)c.offsets=[arguments[4],arguments[5]]}var e=new la(c);e.clone=function(){return new la(c)};return e};this.makeDynamicAnchor=function(a){return new pa(a)};this.repaint=function(a){var b=function(e){e=G(e);N(e)};if(typeof a=="object")for(var c=0;c<a.length;c++)b(a[c]);else b(a)};this.repaintEverything=function(){for(var a in n)N(G(a))};this.removeAllEndpoints=function(a){a=O(a,"id");f.detachAll(a);
var b=n[a],c;for(c in b)S(b[c].canvas,b[c].getElement());n[a]=[]};this.removeEveryEndpoint=function(){for(var a in n){var b=n[a];if(b&&b.length)for(var c=0;c<b.length;c++)S(b[c].canvas,b[c].container)}delete n;n={}};this.removeEndpoint=function(a,b){var c=O(a,"id");n[c]&&Z(n,c,b)&&S(b.canvas,b.getElement())};this.reset=function(){this.detachEverything();this.removeEveryEndpoint();this.clearCache()};this.setAutomaticRepaint=function(){};this.setDefaultNewCanvasSize=function(a){F=a};this.setDefaultScope=
function(a){C=a};this.setDraggable=function(a,b){return R(a,function(c,e){i[e]=b;f.CurrentLibrary.isDragSupported(c)&&f.CurrentLibrary.setDraggable(c,b)})};this.setDraggableByDefault=function(a){z=a};this.setDebugLog=function(a){u=a};this.setRepaintFunction=function(){};this.show=function(a){ka(a,"block")};this.sizeCanvas=function(a,b,c,e,j){if(a){a.style.height=j+"px";a.height=j;a.style.width=e+"px";a.width=e;a.style.left=b+"px";a.style.top=c+"px"}};this.getTestHarness=function(){return{endpointCount:function(a){return(a=
n[a])?a.length:0},connectionCount:function(a){a=a||C;return(a=g[a])?a.length:0},findIndex:D,getId:Y}};this.toggleVisible=this.toggle=na;this.toggleDraggable=function(a){return R(a,function(b,c){var e=i[c]==null?z:i[c];e=!e;i[c]=e;f.CurrentLibrary.setDraggable(b,e);return e})};this.unload=function(){delete n;delete h;delete d;delete p;delete i};this.wrap=T;this.addListener=function(a,b){if(typeof a=="object"&&a.length)for(var c=0;c<a.length;c++)I(r,a[c],b);else I(r,a,b)}},f=window.jsPlumb=new x;f.getInstance=
function(k){var s=new x;k&&f.extend(s.Defaults,k);return s}})();
(function(){jsPlumb.Anchors.TopCenter=jsPlumb.makeAnchor(0.5,0,0,-1);jsPlumb.Anchors.BottomCenter=jsPlumb.makeAnchor(0.5,1,0,1);jsPlumb.Anchors.LeftMiddle=jsPlumb.makeAnchor(0,0.5,-1,0);jsPlumb.Anchors.RightMiddle=jsPlumb.makeAnchor(1,0.5,1,0);jsPlumb.Anchors.Center=jsPlumb.makeAnchor(0.5,0.5,0,0);jsPlumb.Anchors.TopRight=jsPlumb.makeAnchor(1,0,0,-1);jsPlumb.Anchors.BottomRight=jsPlumb.makeAnchor(1,1,0,1);jsPlumb.Anchors.TopLeft=jsPlumb.makeAnchor(0,0,0,-1);jsPlumb.Anchors.BottomLeft=jsPlumb.makeAnchor(0,
1,0,1);jsPlumb.Anchors.AutoDefault=function(){return jsPlumb.makeDynamicAnchor([jsPlumb.Anchors.TopCenter,jsPlumb.Anchors.RightMiddle,jsPlumb.Anchors.BottomCenter,jsPlumb.Anchors.LeftMiddle])};jsPlumb.Defaults.DynamicAnchors=[jsPlumb.Anchors.TopCenter,jsPlumb.Anchors.RightMiddle,jsPlumb.Anchors.BottomCenter,jsPlumb.Anchors.LeftMiddle];jsPlumb.Connectors.Straight=function(){var x=this,f=null,k,s,u,t,n,o,g,h,p;this.compute=function(i,z,d,r,C,F){d=Math.abs(i[0]-z[0]);r=Math.abs(i[1]-z[1]);var D=0.45*
d,I=0.45*r;d*=1.9;r*=1.9;var N=Math.min(i[0],z[0])-D,R=Math.min(i[1],z[1])-I;C=Math.max(2*C,F);if(d<C){d=C;N=i[0]+(z[0]-i[0])/2-C/2;D=(d-Math.abs(i[0]-z[0]))/2}if(r<C){r=C;R=i[1]+(z[1]-i[1])/2-C/2;I=(r-Math.abs(i[1]-z[1]))/2}o=i[0]<z[0]?D:d-D;g=i[1]<z[1]?I:r-I;h=i[0]<z[0]?d-D:D;p=i[1]<z[1]?r-I:I;f=[N,R,d,r,o,g,h,p];u=h-o;t=p-g;k=t/u;s=-1*(k*o-g);n=Math.atan(k);return f};this.paint=function(i,z){z.beginPath();z.moveTo(i[4],i[5]);z.lineTo(i[6],i[7]);z.stroke()};this.pointOnPath=function(i){i=o+i*u;
return[i,k==Infinity?i+s:k*i+s]};this.gradientAtPoint=function(){return k};this.pointAlongPathFrom=function(i,z){var d=x.pointOnPath(i),r=z>0?1:-1,C=Math.abs(z*Math.sin(n));if(g>p)C*=-1;var F=Math.abs(z*Math.cos(n));if(o>h)F*=-1;return[d[0]+r*F,d[1]+r*C]};this.perpendicularToPathAt=function(i,z,d){i=x.pointAlongPathFrom(i,z);z=x.gradientAtPoint(i.location);var r=Math.atan(-1/z);z=d/2*Math.sin(r);d=d/2*Math.cos(r);return[[i[0]+d,i[1]+z],[i[0]-d,i[1]-z]]};this.createGradient=function(i,z){return z.createLinearGradient(i[4],
i[5],i[6],i[7])}};jsPlumb.Connectors.Bezier=function(x){var f=this;this.majorAnchor=x||150;this.minorAnchor=10;var k=null;this._findControlPoint=function(d,r,C,F,D){F=F.getOrientation();D=D.getOrientation();var I=[],N=f.majorAnchor,R=f.minorAnchor;if(F[0]!=D[0]||F[1]==D[1]){D[0]==0?I.push(C[0]<r[0]?d[0]+R:d[0]-R):I.push(d[0]+N*D[0]);D[1]==0?I.push(C[1]<r[1]?d[1]+R:d[1]-R):I.push(d[1]+N*F[1])}else{F[0]==0?I.push(r[0]<C[0]?d[0]+R:d[0]-R):I.push(d[0]-N*F[0]);F[1]==0?I.push(r[1]<C[1]?d[1]+R:d[1]-R):I.push(d[1]+
N*D[1])}return I};var s,u,t,n,o,g,h,p,i;this.compute=function(d,r,C,F,D,I){D=D||0;p=Math.abs(d[0]-r[0])+D;i=Math.abs(d[1]-r[1])+D;g=Math.min(d[0],r[0])-D/2;h=Math.min(d[1],r[1])-D/2;t=d[0]<r[0]?p-D/2:D/2;o=d[1]<r[1]?i-D/2:D/2;n=d[0]<r[0]?D/2:p-D/2;_ty=d[1]<r[1]?D/2:i-D/2;s=f._findControlPoint([t,o],d,r,C,F);u=f._findControlPoint([n,_ty],r,d,F,C);d=Math.min(Math.min(t,n),Math.min(s[0],u[0]));r=Math.max(Math.max(t,n),Math.max(s[0],u[0]));if(r>p)p=r;if(d<0){g+=d;d=Math.abs(d);p+=d;s[0]+=d;t+=d;n+=d;
u[0]+=d}d=Math.min(Math.min(o,_ty),Math.min(s[1],u[1]));r=Math.max(Math.max(o,_ty),Math.max(s[1],u[1]));if(r>i)i=r;if(d<0){h+=d;d=Math.abs(d);i+=d;s[1]+=d;o+=d;_ty+=d;u[1]+=d}if(I&&p<I){d=(I-p)/2;p=I;g-=d;t+=d;n+=d;s[0]+=d;u[0]+=d}return k=[g,h,p,i,t,o,n,_ty,s[0],s[1],u[0],u[1]]};this.paint=function(d,r){r.beginPath();r.moveTo(d[4],d[5]);r.bezierCurveTo(d[8],d[9],d[10],d[11],d[6],d[7]);r.stroke()};this.pointOnPath=function(d){return[t*d*d*d+s[0]*3*d*d*(1-d)+u[0]*3*d*(1-d)*(1-d)+n*(1-d)*(1-d)*(1-d),
o*d*d*d+s[1]*3*d*d*(1-d)+u[1]*3*d*(1-d)*(1-d)+_ty*(1-d)*(1-d)*(1-d)]};this.gradientAtPoint=function(d){var r=f.pointOnPath(d);d=[t*d*d+s[0]*2*d*(1-d)+u[0]*(1-d)*(1-d),o*d*d+s[1]*2*d*(1-d)+u[1]*(1-d)*(1-d)];return Math.atan((d[1]-r[1])/(d[0]-r[0]))};var z=function(d,r){for(var C=f.pointOnPath(d),F=0,D=d,I=r>0?1:-1,N=null;F<Math.abs(r);){D+=0.0050*I;N=f.pointOnPath(D);F+=Math.sqrt(Math.pow(N[0]-C[0],2)+Math.pow(N[1]-C[1],2));C=N}return{point:N,location:D}};this.pointAlongPathFrom=function(d,r){return z(d,
r).point};this.perpendicularToPathAt=function(d,r,C){d=z(d,r);r=f.gradientAtPoint(d.location);var F=Math.atan(-1/r);r=C/2*Math.sin(F);C=C/2*Math.cos(F);return[[d.point[0]+C,d.point[1]+r],[d.point[0]-C,d.point[1]-r]]};this.createGradient=function(d,r,C){return C?r.createLinearGradient(d[4],d[5],d[6],d[7]):r.createLinearGradient(d[6],d[7],d[4],d[5])}};jsPlumb.Endpoints.Dot=function(x){x=x||{radius:10};var f=this;this.radius=x.radius;var k=0.5*this.radius,s=this.radius/3,u=function(t){try{return parseInt(t)}catch(n){if(t.substring(t.length-
1)=="%")return parseInt(t.substring(0,t-1))}};this.paint=function(t,n,o,g,h){var p=g.radius||f.radius;jsPlumb.sizeCanvas(o,t[0]-p,t[1]-p,p*2,p*2);t=o.getContext("2d");o=jsPlumb.extend({},g);if(o.fillStyle==null)o.fillStyle=h.strokeStyle;jsPlumb.extend(t,o);h=/MSIE/.test(navigator.userAgent)&&!window.opera;if(g.gradient&&!h){h=g.gradient;o=k;var i=s;if(h.offset)o=u(h.offset);if(h.innerRadius)i=u(h.innerRadius);h=[o,i];n=t.createRadialGradient(p,p,p,p+(n[0]==1?h[0]*-1:h[0]),p+(n[1]==1?h[0]*-1:h[0]),
h[1]);for(h=0;h<g.gradient.stops.length;h++)n.addColorStop(g.gradient.stops[h][0],g.gradient.stops[h][1]);t.fillStyle=n}t.beginPath();t.arc(p,p,p,0,Math.PI*2,true);t.closePath();t.fill()}};jsPlumb.Endpoints.Rectangle=function(x){x=x||{width:20,height:20};var f=this;this.width=x.width;this.height=x.height;this.paint=function(k,s,u,t,n){var o=t.width||f.width,g=t.height||f.height;jsPlumb.sizeCanvas(u,k[0]-o/2,k[1]-g/2,o,g);k=u.getContext("2d");u=jsPlumb.extend({},t);if(u.fillStyle==null)u.fillStyle=
n.strokeStyle;jsPlumb.extend(k,u);n=/MSIE/.test(navigator.userAgent)&&!window.opera;if(t.gradient&&!n){s=k.createLinearGradient(s[0]==1?o:s[0]==0?o/2:0,s[1]==1?g:s[1]==0?g/2:0,s[0]==-1?o:s[0]==0?g/2:0,s[1]==-1?g:s[1]==0?g/2:0);for(n=0;n<t.gradient.stops.length;n++)s.addColorStop(t.gradient.stops[n][0],t.gradient.stops[n][1]);k.fillStyle=s}k.beginPath();k.rect(0,0,o,g);k.closePath();k.fill()}};jsPlumb.Endpoints.Triangle=function(x){x=x||{width:15,height:15};var f=this;this.width=x.width;this.height=
x.height;this.paint=function(k,s,u,t){var n=t.width||f.width,o=t.height||f.height;jsPlumb.sizeCanvas(u,k[0]-n/2,k[1]-o/2,n,o);k=u.getContext("2d");var g=u=0,h=0;if(s[0]==1){u=n;g=o;h=180}if(s[1]==-1){u=n;h=90}if(s[1]==1){g=o;h=-90}k.fillStyle=t.fillStyle;k.translate(u,g);k.rotate(h*Math.PI/180);k.beginPath();k.moveTo(0,0);k.lineTo(n/2,o/2);k.lineTo(0,o);k.closePath();k.fill()}};jsPlumb.Endpoints.Image=function(x){var f=this;this.img=new Image;this.img.onload=function(){f.ready=true};this.img.src=
x.url;var k=function(s,u,t,n){u=f.img.width||n.width;n=f.img.height||n.height;jsPlumb.sizeCanvas(t,s[0]-u/2,s[1]-n/2,u,n);t.getContext("2d").drawImage(f.img,0,0)};this.paint=function(s,u,t,n,o){f.ready?k(s,u,t,n,o):window.setTimeout(function(){f.paint(s,u,t,n,o)},200)}};jsPlumb.Overlays.Arrow=function(x){x=x||{};var f=this,k=x.length||20,s=x.width||20,u=x.fillStyle||"black",t=x.strokeStyle,n=x.lineWidth||1;this.loc=x.location||0.5;var o=x.foldback||0.623;this.computeMaxSize=function(){return s*1.5};
this.draw=function(g,h){var p=g.pointAlongPathFrom(f.loc,k/2);g.pointAlongPathFrom(f.loc,-k/2);var i=g.perpendicularToPathAt(f.loc,-k/2,s),z;z=f.loc;z=o==0.5?g.pointOnPath(z):g.pointAlongPathFrom(z,k*(0.5-o));h.lineWidth=n;h.beginPath();h.moveTo(p[0],p[1]);h.lineTo(i[0][0],i[0][1]);h.lineTo(z[0],z[1]);h.lineTo(i[1][0],i[1][1]);h.lineTo(p[0],p[1]);h.closePath();if(t){h.strokeStyle=t;h.stroke()}h.fillStyle=u;h.fill()}};jsPlumb.Overlays.PlainArrow=function(x){x=x||{};x=jsPlumb.extend(x,{foldback:1});
jsPlumb.Overlays.Arrow.call(this,x)};jsPlumb.Overlays.Diamond=function(x){x=x||{};x=jsPlumb.extend(x,{length:(x.length||40)/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,x)};jsPlumb.Overlays.Label=function(x){this.labelStyle=x.labelStyle||jsPlumb.Defaults.LabelStyle;this.label=x.label;var f=this,k=null,s=null,u=null,t=null;this.location=x.location||0.5;this.computeMaxSize=function(n,o){if(u){o.save();if(f.labelStyle.font)o.font=f.labelStyle.font;var g=o.measureText(u).width,h=o.measureText("M").width;
t=f.labelStyle.padding||0.25;k=g+2*g*t;s=h+2*h*t;o.restore();return Math.max(k,s)*1.5}return 0};this.draw=function(n,o){if(u=typeof f.label=="function"?f.label(f):f.label){if(f.labelStyle.font)o.font=f.labelStyle.font;var g=o.measureText(u).width,h=o.measureText("M").width;t=f.labelStyle.padding||0.25;k=g+2*g*t;s=h+2*h*t;g=n.pointOnPath(f.location);if(f.labelStyle.font)o.font=f.labelStyle.font;o.fillStyle=f.labelStyle.fillStyle?f.labelStyle.fillStyle:"rgba(0,0,0,0)";o.fillRect(g[0]-k/2,g[1]-s/2,k,
s);if(f.labelStyle.color)o.fillStyle=f.labelStyle.color;o.textBaseline="middle";o.textAlign="center";o.fillText(u,g[0],g[1]);if(f.labelStyle.borderWidth>0){o.strokeStyle=f.labelStyle.borderStyle||"black";o.strokeRect(g[0]-k/2,g[1]-s/2,k,s)}}}}})();
(function(){var x=new Class({Extends:Fx.Morph,onStep:null,initialize:function(g,h){this.parent(g,h);if(h.onStep)this.onStep=h.onStep},step:function(){this.parent();if(this.onStep)try{this.onStep()}catch(g){}}}),f={},k={},s={},u={},t=function(g,h,p){if(h){var i=h.get("id");if(i)(i=k[i])&&i[p]&&i[p](g,h)}},n=function(g,h){if(g){var p=g.get("id");if(p)if(p=k[p])if(p.hoverClass)h?g.addClass(p.hoverClass):g.removeClass(p.hoverClass)}},o=function(g,h,p){var i=g[h];if(!i){i=[];g[h]=i}i.push(p)};jsPlumb.CurrentLibrary=
{dragEvents:{start:"onStart",stop:"onComplete",drag:"onDrag",step:"onStep",over:"onEnter",out:"onLeave",drop:"onDrop",complete:"onComplete"},appendElement:function(g,h){jsPlumb.CurrentLibrary.getElementObject(h).grab(g)},bind:function(g,h,p){g=jsPlumb.CurrentLibrary.getElementObject(g);g.addEvent(h,p)},extend:function(g,h){return $extend(g,h)},getElementObject:function(g){return $(g)},getOffset:function(g){g=g.getPosition();return{left:g.x,top:g.y}},setOffset:function(g,h){jsPlumb.CurrentLibrary.getElementObject(g).setPosition({x:h.left,
y:h.top})},getSize:function(g){g=g.getSize();return[g.x,g.y]},getAttribute:function(g,h){return g.get(h)},setAttribute:function(g,h,p){g.set(h,p)},addClass:function(g,h){g.addClass(h)},initDraggable:function(g,h){var p=jsPlumb.getId(g),i=u[p];if(!i){var z=0,d=null,r=jsPlumb.Defaults.DragOptions.zIndex||2E3;h.onStart=jsPlumb.wrap(h.onStart,function(){z=this.element.getStyle("z-index");this.element.setStyle("z-index",r);if(jsPlumb.Defaults.DragOptions.cursor){d=this.element.getStyle("cursor");this.element.setStyle("cursor",
jsPlumb.Defaults.DragOptions.cursor)}});h.onComplete=jsPlumb.wrap(h.onComplete,function(){this.element.setStyle("z-index",z);d&&this.element.setStyle("cursor",d)});p=h.scope||jsPlumb.Defaults.Scope;i=function(C){return C.get("id")!=g.get("id")};i=f[p]?f[p].filter(i):[];h.droppables=i;h.onLeave=jsPlumb.wrap(h.onLeave,function(C,F){if(F){n(F,false);t(C,F,"onLeave")}});h.onEnter=jsPlumb.wrap(h.onEnter,function(C,F){if(F){n(F,true);t(C,F,"onEnter")}});h.onDrop=function(C,F){if(F){n(F,false);t(C,F,"onDrop")}};
i=new Drag.Move(g,h);o(s,p,i);o(u,g.get("id"),i);h.disabled&&i.detach()}return i},isDragSupported:function(){return typeof Drag!="undefined"},setDraggable:function(g,h){var p=u[g.get("id")];p&&p.each(function(i){h?i.attach():i.detach()})},initDroppable:function(g,h){var p=h.scope||jsPlumb.Defaults.Scope;o(f,p,g);var i=jsPlumb.getId(g);k[i]=h;i=function(z){return z.element!=g};p=s[p]?s[p].filter(i):[];for(i=0;i<p.length;i++)p[i].droppables.push(g)},isDropSupported:function(){if(typeof Drag!=undefined)return typeof Drag.Move!=
undefined;return false},animate:function(g,h,p){(new x(g,p)).start(h)},getUIPosition:function(g){g=g[0];return{left:g.offsetLeft,top:g.offsetTop}},getDragObject:function(g){return g[0]},removeElement:function(g){jsPlumb.CurrentLibrary.getElementObject(g).dispose()},getScrollLeft:function(){return null},getScrollTop:function(){return null}}})();