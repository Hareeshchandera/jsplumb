<!doctype html>
<html>

<!-- 


this is a work in progress.  don't rely on anything you find in this file!

it's an experimental demo for the updates being made in jsPlumb 1.3.0 - support for SVG in browsers that
have it, and 'native' VML (i'm dropping the dependency on excanvas) for older IE, which allows jsPlumb to support
mouse events, not to mention running a whole lot quicker.




 -->

	<head>
		<title>jsPlumb 1.3.0 demo - MooTools</title>
		<meta http-equiv="content-type" content="text/html;charset=utf-8" />
		<link rel="stylesheet" href="/mp.css"></link>
		<link rel="stylesheet" href="../../css/jsPlumbDemo.css">
		<link rel="stylesheet" href="../../css/demo.css">				
	</head>
	<body onunload="jsPlumb.unload();">
	
		<div class="menu"><a href="../doc/usage.html" class="mplink">view documentation</a>&nbsp;|&nbsp;<a href="mailto:simon.porritt@gmail.com" class="mplink">contact me</a>&nbsp;|&nbsp;<a href="http://code.google.com/p/jsplumb/" class="mplink">jsPlumb on Google code</a></div>
	
		<div id="demo">
			<div class="component window" id="window1"><strong>Window 1</strong><br/><br/>i am plumbed with a yellow Bezier connector to Window 2.</div>
			<div class="component window" id="window2"><strong>Window 2</strong><br/><br/>i am plumbed with a yellow Bezier connector to Window 1, and a Bezier connector with square endpoints to Window 3</div>
		    <div class="component window" id="window3"><strong>Window 3</strong><br/><br/>i am plumbed with a Bezier connector and square endpoints to Window 2, and a Bezier connector with custom style to Window 4. My blue endpoint tracks Window 4.</div>
		    <div class="component window" id="window4"><strong>Window 4</strong><br/><br/>i am plumbed with a Bezier connector with custom style to Window 3, and with a straight line connector with image endpoints to Window 5. My blue endpoint tracks Window 3.</div>
		    <div class="component window" id="window5"><strong>Window 5</strong><br/><br/>i am plumbed with a flowchart connector to Window 6, between our two centerpoints, which are drawn below, and larger than, the window element; i am also plumbed to Window 4.</div>
		    <div class="component window" id="window6"><strong>Window 6</strong><br/><br/>i am plumbed with a flowchart connector to Window 5, between our two centerpoints, which are drawn below, and larger than, the window element.</div>
		 </div>	
	    
	    <div id="debug"></div>
	    
	    <div id="explanation">
	    	<p>jsPlumb provides a way to "plumb" elements of a UI together.  </p>
	    	<p>This demonstration uses jsPlumb 1.3.0-RC1, MooTools 1.3.2, and Drag.Move from MooTools More 1.3.2.1.</p>
	    	<a href="flowchartConnectorsDemo.html" class="mplink">next: flowchart connectors demonstration</a>
	    	<br/><br/>
	    	render mode:&nbsp;<a href="#" class="rmode" mode="svg">SVG</a>&nbsp;|&nbsp;<a href="#" class="selected rmode" mode="canvas">Canvas</a>&nbsp;|&nbsp;<a href="#" class="rmode" mode="vml">VML</a>
	    	<br/><br/>
	    	You also might like to check out <a class="mplink" href="http://tweetplumb.com?q=#jquery" target="_blank">TweetPlumb</a>, a Twitter visualisation built with jsPlumb.
	    	<br/><br/>
	    	See a <a href="../../jquery/1.3.0/demo.html">jQuery version</a> of this demo.<br/>
	    	See a <a href="../../yui3/1.3.0/demo.html">YUI3 version</a> of this demo.
	    </div>
	    
	    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/mootools/1.3.2/mootools-yui-compressed.js"></script>
		<script type="text/javascript" src="../../../js/lib/mootools-1.3.2.1-more.js"></script>
				
		<!-- support lib for bezier stuff -->
		<script type="text/javascript" src="../../../js/lib/jsBezier-0.2-min.js"></script>
		<!-- main jsplumb engine -->
		<script type="text/javascript" src="../../../js/1.3.0/jsPlumb-1.3.0-RC1.js"></script>
		<!-- connectors, endpoint and overlays  -->
		<script type="text/javascript" src="../../../js/1.3.0/jsPlumb-defaults-1.3.0-RC1.js"></script>
		<!-- SVG renderer -->
		<script type="text/javascript" src="../../../js/1.3.0/jsPlumb-renderers-svg-1.3.0-RC1.js"></script>
		<!-- canvas renderer -->
		<script type="text/javascript" src="../../../js/1.3.0/jsPlumb-renderers-canvas-1.3.0-RC1.js"></script>
		<!-- vml renderer -->
		<script type="text/javascript" src="../../../js/1.3.0/jsPlumb-renderers-vml-1.3.0-RC1.js"></script>
		<!-- jquery adapter -->
		<script type="text/javascript" src="../../../js/1.3.0/mootools.jsPlumb-1.3.0-RC1.js"></script>
							            	
		<script type="text/javascript">
			jsPlumb.bind("ready", function() {

				// chrome fix.
				document.onselectstart = function () { return false; };

				var init = function() {
					
					jsPlumb.DefaultDragOptions = { cursor: "pointer", zIndex:2000 };
					jsPlumb.setMouseEventsEnabled(true);

					var connectorStrokeColor = "rgba(50, 50, 200, 1)",
					connectorHighlightStrokeColor = "rgba(180, 180, 200, 1)",
					hoverPaintStyle = { lineWidth:13,strokeStyle:"#7ec3d9" };			
					
					// 
					// connect window1 to window2 with a 13 px wide olive colored Bezier, from the BottomCenter of 
					// window1 to 3/4 of the way along the top edge of window2.  give the connection a 1px black outline,
					// and allow the endpoint styles to derive their color and outline from the connection.
					// label it "Connection One" with a label at 0.7 of the length of the connection, and put an arrow that has a 50px
					// wide tail at a point 0.2 of the length of the connection.  we use 'cssClass' and 'endpointClass' to assign
					// our own css classes, and the Label overlay has three css classes specified for it too.  we also give this
					// connection a 'hoverPaintStyle', which defines the appearance when the mouse is hovering over it. 
					//
					var connection1 = jsPlumb.connect({
						source:'window1', 
					   	target:'window2', 
					   	connector:"Bezier",
					   	cssClass:"c1",
					   	endpointClass:"c1Endpoint",													   
					   	anchors:["BottomCenter", [ 0.75, 0, 0, -1 ]], 
					   	paintStyle:{ 
							lineWidth:13,
							strokeStyle:"#a7b04b",
							outlineWidth:1,
							outlineColor:"#666"/*,
							dashstyle:"2 2"*/
						},
					   	hoverPaintStyle:hoverPaintStyle,
					   	overlays : [ ["Label", {													   					
					   					cssClass:"l1 component label",
					   					label : "Connection One", 
					   					location:0.7,
					   					id:"label",
					   					events:{
											"click":function(connection, label) {
												alert("clicked on label for connection 1");
					   						}
					   					}
					   				  } ],
					   				["Arrow", {location:0.2, width:50}]
					]});
								        
			        var w23Stroke = "rgb(189,11,11)"; 
			        var connection3 = jsPlumb.connect({
							source:"window2", 
			      				target:"window3", 
			      				paintStyle:{ 
									lineWidth:8,
									strokeStyle:w23Stroke,
									outlineColor:"#666",
									outlineWidth:1 
								},
			      				hoverPaintStyle:hoverPaintStyle, 
			      				anchors:[ [ 0.3 , 1, 0, 1 ], "TopCenter" ], 
			      				endpoint:"Rectangle", 
			      				endpointStyles:[
			      		        	{ gradient : { stops:[[0, w23Stroke], [1, "#558822"]] }},
				    			{ gradient : {stops:[[0, w23Stroke], [1, "#882255"]] }}
				    		]
					});					
						
					var connection2 = jsPlumb.connect({source:'window3', target:'window4', 
				        				 paintStyle:{ 
			    				 							lineWidth:10, 
			    				 							strokeStyle:connectorStrokeColor,
			    				 							outlineColor:"#666",
			    				 							outlineWidth:1
			    				 					},
				        				 hoverPaintStyle:hoverPaintStyle, 
				        				 anchors:["AutoDefault", "AutoDefault"], 
				        				 endpointStyle:{ 
					        				 	gradient : { 
					        				 		stops:[[0, connectorStrokeColor], [1, connectorHighlightStrokeColor]],
					        				 		offset:17.5, 
					        				 		innerRadius:15 
					        				 	}, 
					        				 	radius:35
					        			 },				        					        			
				        				 label : function(connection) { 
					        				 var d = new Date();
					        				 var fmt = function(n) { return (n < 10 ? "0" : "") + n; }; 
					        				 return (fmt(d.getHours()) + ":" + fmt(d.getMinutes()) + ":" + fmt(d.getSeconds())+ "." + fmt(d.getMilliseconds())); 
					        			 },
					        			 labelStyle:{
					        				 cssClass:"component label"
					        			 }
				        			});

					
			        var conn4Color = "rgba(46,164,26,0.8)";
			        var connection4 = jsPlumb.connect({  
				        						source:'window5', 
				        						target:'window6', 
				        						connector:"Flowchart",
				        						anchors:["Center", "Center"],  
				        						paintStyle:{ 
													lineWidth:9, 
													strokeStyle:conn4Color, 
													outlineColor:"#666",
							 						outlineWidth:1
							 					},
				        						hoverPaintStyle:hoverPaintStyle,
				        						endpointsOnTop:false, 
				        						endpointStyle:{ radius:95, fillStyle:conn4Color },
				        						labelStyle : { cssClass:"component label" },
				        						label : "big\nendpoints"
				        				});

			        
			        var connection5 = jsPlumb.connect({
				        					source:"window4", 
				        					target:"window5", 
				        					anchors:["BottomRight", "TopLeft"], 
				        					paintStyle:{ 
												lineWidth:7,
												strokeStyle:"rgb(131,8,135)",
												outlineColor:"#666",
								 				outlineWidth:1 
			   								},
				        					hoverPaintStyle:hoverPaintStyle, 
				        					endpoint:["Image", {url:"../../../img/endpointTest1.png"}], 
				        					connector:"Straight", 
				        					endpointsOnTop:true,
											overlays:[ ["Label", {
															cssClass:"component label",		    			        				 
									    			        label : "4 - 5",
									    			        location:0.3 } ]
											]});

					jsPlumb.bind("dblclick", function(connection, originalEvent) { alert("double click on connection from " + connection.sourceId + " to " + connection.targetId); });
					jsPlumb.bind("endpointClick", function(endpoint, originalEvent) { alert("click on endpoint on element " + endpoint.elementId); });
				};

				

		     // render mode
			var resetRenderMode = function(desiredMode) {
				var newMode = jsPlumb.setRenderMode(desiredMode);
				$$(".rmode").each(function(e) { e.removeClass("selected") });
				$$(".rmode[mode='" + newMode + "']").each(function(e) { e.addClass("selected") });
				var disableList = (newMode === jsPlumb.VML) ? ".rmode[mode='canvas'],.rmode[mode='svg']" : ".rmode[mode='vml']"; 
				$$(disableList).each(function(e) { 
					e.set("disabled", true) 
				});				
				init();
			};
		     
			$$(".rmode").each(function(r) {
				r.addEvent("click", function() {
					var desiredMode = $(this).get("mode");
					jsPlumb.reset();
					resetRenderMode(desiredMode);					
				});
			});

			resetRenderMode(jsPlumb.CANVAS);
		       
		});
		</script>

	</body>
</html>
